# ============================================================================
# Curatore Platform — Root Environment Configuration
# ============================================================================
# Single source of truth for ALL variables across the platform.
#
# How it works:
#   1. Copy this file:  cp .env.example .env
#   2. Fill in REQUIRED values below
#   3. Run bootstrap:   ./scripts/bootstrap.sh
#
# The bootstrap script reads this file and runs generate-env.sh, which
# distributes settings to each service's .env and config.yml. You should
# NOT edit per-service .env files directly — edit this file and re-run:
#
#   ./scripts/generate-env.sh
#
# Config philosophy:
#   .env        = secrets, credentials, infrastructure endpoints, dev toggles
#   config.yml  = application behavior, feature flags, LLM routing, search tuning
#
# See docs/CONFIGURATION.md for full reference.
# ============================================================================


# ============================================================================
# LLM — Language Model Provider (REQUIRED)
# ============================================================================
# Used by the backend for document evaluation, CWR procedures, embeddings,
# and all AI-powered features. Supports OpenAI-compatible APIs (direct
# OpenAI, LiteLLM proxy, Azure OpenAI, etc.).
#
# These values are injected into config.yml by generate-env.sh. Task-type
# routing (embedding, quick, standard, quality, reasoning) is configured
# in config.yml, not here.

# API key for your LLM provider
OPENAI_API_KEY=

# Base URL for the LLM API (change for LiteLLM proxy, Azure, or local models)
OPENAI_BASE_URL=https://litellm.prod.amivero-solutions.com

# Default model used for all LLM task types unless overridden below
OPENAI_MODEL=claude-4-5-sonnet

# --- Per-Task-Type Model Overrides (optional) ---
# Each task type can use a different model and temperature. If not set,
# models default to OPENAI_MODEL above with preset temperatures.
#
# Embedding model (vector representations for semantic search)
# LLM_EMBEDDING_MODEL=text-embedding-3-large
# LLM_EMBEDDING_DIMENSIONS=1536
#
# Quick tasks (classify, decide, route — very deterministic)
# LLM_QUICK_MODEL=claude-4-5-sonnet
# LLM_QUICK_TEMPERATURE=0.1
#
# Standard tasks (summarize, extract, generate — balanced)
# LLM_STANDARD_MODEL=claude-4-5-sonnet
# LLM_STANDARD_TEMPERATURE=0.5
#
# Quality tasks (evaluate, final reports — controlled but nuanced)
# LLM_QUALITY_MODEL=claude-4-5-sonnet
# LLM_QUALITY_TEMPERATURE=0.3
#
# Bulk tasks (high-volume batch processing — consistent)
# LLM_BULK_MODEL=claude-4-5-sonnet
# LLM_BULK_TEMPERATURE=0.3
#
# Reasoning tasks (complex multi-step analysis — logical, low variance)
# LLM_REASONING_MODEL=claude-4-5-sonnet
# LLM_REASONING_TEMPERATURE=0.2


# ============================================================================
# Microsoft Graph — SharePoint Integration (REQUIRED)
# ============================================================================
# Azure AD app registration credentials for SharePoint document sync.
# The backend uses these to authenticate with Microsoft Graph API and
# pull documents from SharePoint sites/libraries.
#
# To obtain: Register an app in Azure Portal > App registrations,
# grant Microsoft Graph API permissions (Sites.Read.All, Files.Read.All),
# and create a client secret.

# Azure AD tenant ID (GUID) — identifies your Azure AD directory
MS_TENANT_ID=

# Application (client) ID from the Azure app registration
MS_CLIENT_ID=

# Client secret value (not the secret ID) from the app registration
MS_CLIENT_SECRET=

# Email sender address for Microsoft Graph email (e.g., noreply@yourcompany.com).
# When set along with Graph credentials, invitation and notification emails are
# sent via the Microsoft Graph API instead of the console backend.
MS_EMAIL_SENDER=


# ============================================================================
# SAM.gov — Government Opportunities (REQUIRED)
# ============================================================================
# API key for accessing SAM.gov contract opportunities data.
# Register at https://sam.gov/content/entity-registration to obtain a key.
# Used by the SAM connector to pull and sync opportunity data.

SAM_API_KEY=


# ============================================================================
# Auto-Generated Secrets
# ============================================================================
# These are generated automatically by bootstrap.sh if left blank.
# You can set them manually for deterministic environments (CI, staging).

# JWT signing key — used to sign and verify authentication tokens.
# Must be a strong random string. If changed, all existing sessions are
# invalidated.
JWT_SECRET_KEY=

# MCP Gateway shared secret — authenticates requests between the MCP
# service and the backend. Also used as TRUSTED_SERVICE_KEY for
# delegated auth (MCP acting on behalf of users).
MCP_API_KEY=

# Document Service API key — authenticates backend requests to the
# document extraction service. When set, the service validates
# Authorization: Bearer <key>. When empty, the service runs in dev mode
# (no auth required).
DOCUMENT_SERVICE_API_KEY=

# Playwright Service API key — same pattern as Document Service.
# Authenticates backend requests to the browser rendering service.
PLAYWRIGHT_API_KEY=

# MinIO root credentials — used by the MinIO container itself and by
# the backend to access object storage. MINIO_ROOT_USER is the admin
# username; MINIO_ROOT_PASSWORD is auto-generated if blank.
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=

# PostgreSQL password — used by the postgres container and by the
# backend's DATABASE_URL connection string. Auto-generated if blank.
POSTGRES_PASSWORD=


# ============================================================================
# Optional Overrides (defaults work for local development)
# ============================================================================

# --- Admin User Seeding ---
# Created on first bootstrap via: docker exec curatore-backend python -m
# app.core.commands.seed --create-admin
ADMIN_EMAIL=admin@example.com
ADMIN_PASSWORD=changeme
ADMIN_USERNAME=admin
ADMIN_FULL_NAME=Admin User

# --- Default Organization ---
# Created alongside the admin user during seeding. All non-admin users
# are assigned to organizations via user_organization_memberships.
DEFAULT_ORG_NAME=Default Organization
DEFAULT_ORG_SLUG=default

# --- Debug & Logging ---
# DEBUG=true enables verbose logging across all services.
# LOG_LEVEL controls the Python logging level (DEBUG, INFO, WARNING, ERROR).
DEBUG=true
LOG_LEVEL=INFO

# --- PostgreSQL ---
# Database name and user for the PostgreSQL container. These are combined
# with POSTGRES_PASSWORD to build the DATABASE_URL connection string:
#   postgresql+asyncpg://<user>:<password>@postgres:5432/<db>
POSTGRES_DB=curatore
POSTGRES_USER=curatore

# Set to true to include the local PostgreSQL container when using
# ./scripts/dev-up.sh --with-postgres
ENABLE_POSTGRES_SERVICE=true

# --- CORS ---
# JSON array of allowed origins for browser requests. In local dev,
# the frontend runs at http://localhost:3000.
CORS_ORIGINS=["http://localhost:3000"]

# --- Authentication ---
# Set to false to bypass JWT/API-key auth on all endpoints (local dev only).
# When false, all requests are treated as the default admin user.
ENABLE_AUTH=true

# --- Email ---
# EMAIL_BACKEND: "console" prints emails to logs (dev), "smtp" sends real
# email. See config.yml for SMTP host/port/credentials when using smtp.
EMAIL_BACKEND=console
EMAIL_FROM_ADDRESS=noreply@curatore.app
EMAIL_FROM_NAME=Curatore

# --- Search ---
# Enable hybrid full-text + semantic search (PostgreSQL + pgvector).
# Search tuning (mode, weights, chunk size) is in config.yml.
SEARCH_ENABLED=true

# --- Docling ---
# Embedded Docling container for advanced document extraction (OCR + layout).
# When enabled, the document-service compose file starts a Docling sidecar.
# When disabled, set DOCLING_SERVICE_URL manually for an external instance.
ENABLE_DOCLING_SERVICE=false
ENABLE_DOCLING_GPU=false
ENABLE_DOCLING_UI=false
